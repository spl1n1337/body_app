import{S as Be,i as Oe,s as Ze,e as p,f as L,h as g,j as E,m as M,l as h,x as i,F as pe,K as fe,n as B,o as c,E as ee,H as xe,q as De,G as Ae,Z as Ne,y as Re,_ as He,$ as We,a0 as Ee,J as we,A as Ie,d as J,B as ke,k as z,C as qe,t as ve,b as ge,N as Ge,D as Pe,r as Ue,P as je}from"../chunks/index.38a176c8.js";import{C as Ye}from"../chunks/Container.08fd762d.js";import{T as Xe}from"../chunks/TrainingHeader.6f0bc9ea.js";import{B as Je}from"../chunks/BackArrow.305c4988.js";import{g as be}from"../chunks/navigation.b21568d4.js";import{l as ze}from"../chunks/stores.d58668a2.js";function Le(s,e,t){return s>=e*t?{width:e*t,height:e}:{width:s,height:s/t}}function Ve(s,e,t,r){return{x:Me(s.x,e.width,t.width,r),y:Me(s.y,e.height,t.height,r)}}function Me(s,e,t,r){const n=e*r/2-t/2;return Math.min(n,Math.max(s,-n))}function Te(s,e){return Math.sqrt(Math.pow(s.y-e.y,2)+Math.pow(s.x-e.x,2))}function Ke(s,e,t,r,n,o=!0){const _=o?Qe:$e,l={x:_(100,((e.width-t.width/n)/2-s.x/n)/e.width*100),y:_(100,((e.height-t.height/n)/2-s.y/n)/e.height*100),width:_(100,t.width/e.width*100/n),height:_(100,t.height/e.height*100/n)},u=_(e.naturalWidth,l.width*e.naturalWidth/100,!0),f=_(e.naturalHeight,l.height*e.naturalHeight/100,!0),k=e.naturalWidth>=e.naturalHeight*r?{width:Math.round(f*r),height:f}:{width:u,height:Math.round(u/r)},N={...k,x:_(e.naturalWidth-k.width,l.x*e.naturalWidth/100,!0),y:_(e.naturalHeight-k.height,l.y*e.naturalHeight/100,!0)};return{croppedAreaPercentages:l,croppedAreaPixels:N}}function Qe(s,e,t=!1){const r=t?Math.round(e):e;return Math.min(s,Math.max(0,r))}function $e(s,e){return e}function Ce(s,e){return{x:(e.x+s.x)/2,y:(e.y+s.y)/2}}const{window:et}=We;function Se(s){let e;return{c(){e=p("div"),this.h()},l(t){e=g(t,"DIV",{class:!0,style:!0,"data-testid":!0}),E(e).forEach(h),this.h()},h(){i(e,"class","cropperArea svelte-12kodkg"),fe(e,"width",s[7].width+"px"),fe(e,"height",s[7].height+"px"),i(e,"data-testid","cropper"),Ee(e,"round",s[3]==="round"),Ee(e,"grid",s[4])},m(t,r){B(t,e,r)},p(t,r){r[0]&128&&fe(e,"width",t[7].width+"px"),r[0]&128&&fe(e,"height",t[7].height+"px"),r[0]&8&&Ee(e,"round",t[3]==="round"),r[0]&16&&Ee(e,"grid",t[4])},d(t){t&&h(e)}}}function tt(s){let e,t,r,n,o,_,l=s[7]&&Se(s);return{c(){e=p("div"),t=p("img"),n=L(),l&&l.c(),this.h()},l(u){e=g(u,"DIV",{class:!0,"data-testid":!0});var f=E(e);t=g(f,"IMG",{class:!0,src:!0,alt:!0,style:!0,crossorigin:!0}),n=M(f),l&&l.l(f),f.forEach(h),this.h()},h(){i(t,"class","image svelte-12kodkg"),pe(t.src,r=s[2])||i(t,"src",r),i(t,"alt",""),fe(t,"transform","translate("+s[1].x+"px, "+s[1].y+"px) scale("+s[0]+")"),i(t,"crossorigin",s[5]),i(e,"class","container svelte-12kodkg"),i(e,"data-testid","container")},m(u,f){B(u,e,f),c(e,t),s[20](t),c(e,n),l&&l.m(e,null),s[21](e),o||(_=[ee(et,"resize",s[10]),ee(t,"load",s[9]),ee(e,"mousedown",xe(s[11])),ee(e,"touchstart",xe(s[12])),ee(e,"wheel",xe(s[13]))],o=!0)},p(u,f){f[0]&4&&!pe(t.src,r=u[2])&&i(t,"src",r),f[0]&3&&fe(t,"transform","translate("+u[1].x+"px, "+u[1].y+"px) scale("+u[0]+")"),f[0]&32&&i(t,"crossorigin",u[5]),u[7]?l?l.p(u,f):(l=Se(u),l.c(),l.m(e,null)):l&&(l.d(1),l=null)},i:De,o:De,d(u){u&&h(e),s[20](null),l&&l.d(),s[21](null),o=!1,Ae(_)}}}function st(s,e,t){let{image:r}=e,{crop:n={x:0,y:0}}=e,{zoom:o=1}=e,{aspect:_=4/3}=e,{minZoom:l=1}=e,{maxZoom:u=3}=e,{cropSize:f=null}=e,{cropShape:b="rect"}=e,{showGrid:k=!0}=e,{zoomSpeed:N=1}=e,{crossOrigin:y=null}=e,{restrictPosition:D=!0}=e,I=null,T={width:0,height:0,naturalWidth:0,naturalHeight:0},R=null,x=null,w=null,re={x:0,y:0},X={x:0,y:0},W=0,K=null,Q=null;const G=Ne();Re(()=>{w&&w.complete&&ce(),R&&(R.addEventListener("gesturestart",O),R.addEventListener("gesturechange",O))}),He(()=>{R&&(R.removeEventListener("gesturestart",O),R.removeEventListener("gesturechange",O)),ae()});const O=a=>a.preventDefault(),ae=()=>{typeof document<"u"&&(document.removeEventListener("mousemove",ue),document.removeEventListener("mouseup",q),document.removeEventListener("touchmove",$),document.removeEventListener("touchend",q))},ce=()=>{U(),ne()},S=()=>f?f.width/f.height:_,U=()=>{w&&(T={width:w.width,height:w.height,naturalWidth:w.naturalWidth,naturalHeight:w.naturalHeight},t(7,I=f||Le(w.width,w.height,_))),R&&(x=R.getBoundingClientRect())},ie=a=>({x:Number(a.clientX),y:Number(a.clientY)}),H=a=>({x:Number(a.clientX),y:Number(a.clientY)}),te=a=>{document.addEventListener("mousemove",ue),document.addEventListener("mouseup",q),le(ie(a))},ue=a=>v(ie(a)),se=a=>{document.addEventListener("touchmove",$,{passive:!1}),document.addEventListener("touchend",q),a.touches.length===2?C(a):a.touches.length===1&&le(H(a.touches[0]))},$=a=>{a.preventDefault(),a.touches.length===2?F(a):a.touches.length===1&&v(H(a.touches[0]))},le=({x:a,y:A})=>{re={x:a,y:A},X={x:n.x,y:n.y}},v=({x:a,y:A})=>{K&&window.cancelAnimationFrame(K),K=window.requestAnimationFrame(()=>{if(a===void 0||A===void 0||!I)return;const Z=a-re.x,oe=A-re.y,Y={x:X.x+Z,y:X.y+oe};t(1,n=D?Ve(Y,T,I,o):Y)})},q=()=>{ae(),ne()},C=a=>{const A=H(a.touches[0]),Z=H(a.touches[1]);W=Te(A,Z),le(Ce(A,Z))},F=a=>{const A=H(a.touches[0]),Z=H(a.touches[1]),oe=Ce(A,Z);v(oe),Q&&window.cancelAnimationFrame(Q),Q=window.requestAnimationFrame(()=>{const Y=Te(A,Z),he=o*(Y/W);P(he,oe),W=Y})},V=a=>{const A=ie(a),Z=o-a.deltaY*N/200;P(Z,A)},m=({x:a,y:A})=>{if(!x)throw new Error("The Cropper is not mounted");return{x:x.width/2-(a-x.left),y:x.height/2-(A-x.top)}},d=({x:a,y:A})=>({x:(a+n.x)/o,y:(A+n.y)/o}),P=(a,A)=>{if(!I)return;const Z=m(A),oe=d(Z);t(0,o=Math.min(u,Math.max(a,l)));const Y={x:oe.x*o-Z.x,y:oe.y*o-Z.y};t(1,n=D?Ve(Y,T,I,o):Y)},ne=()=>{if(!I||I.width===0)return;const a=D?Ve(n,T,I,o):n,{croppedAreaPercentages:A,croppedAreaPixels:Z}=Ke(a,T,I,S(),o,D);G("cropcomplete",{percent:A,pixels:Z})};function j(a){we[a?"unshift":"push"](()=>{w=a,t(6,w)})}function de(a){we[a?"unshift":"push"](()=>{R=a,t(8,R)})}return s.$$set=a=>{"image"in a&&t(2,r=a.image),"crop"in a&&t(1,n=a.crop),"zoom"in a&&t(0,o=a.zoom),"aspect"in a&&t(14,_=a.aspect),"minZoom"in a&&t(15,l=a.minZoom),"maxZoom"in a&&t(16,u=a.maxZoom),"cropSize"in a&&t(17,f=a.cropSize),"cropShape"in a&&t(3,b=a.cropShape),"showGrid"in a&&t(4,k=a.showGrid),"zoomSpeed"in a&&t(18,N=a.zoomSpeed),"crossOrigin"in a&&t(5,y=a.crossOrigin),"restrictPosition"in a&&t(19,D=a.restrictPosition)},s.$$.update=()=>{s.$$.dirty[0]&147520&&w&&t(7,I=f||Le(w.width,w.height,_)),s.$$.dirty[0]&1&&o&&ne()},[o,n,r,b,k,y,w,I,R,ce,U,te,se,V,_,l,u,f,N,D,j,de]}class rt extends Be{constructor(e){super(),Oe(this,e,st,tt,Ze,{image:2,crop:1,zoom:0,aspect:14,minZoom:15,maxZoom:16,cropSize:17,cropShape:3,showGrid:4,zoomSpeed:18,crossOrigin:5,restrictPosition:19},null,[-1,-1])}}const at=s=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",n=>t(n)),r.setAttribute("crossOrigin","anonymous"),r.src=s});function it(s){return s*Math.PI/180}async function nt(s,e,t=0){const r=await at(s),n=document.createElement("canvas"),o=n.getContext("2d"),l=2*(Math.max(r.width,r.height)/2);console.log(l),n.width=l,n.height=l,o.translate(l/2,l/2),o.rotate(it(t)),o.translate(-l/2,-l/2),o.drawImage(r,l/2-r.width*.5,l/2-r.height*.5);const u=o.getImageData(0,0,l,l);return n.width=e.width,n.height=e.height,o.putImageData(u,Math.round(0-l/2+r.width*.5-e.x),Math.round(0-l/2+r.height*.5-e.y)),n.toDataURL("image/jpeg")}function lt(s){let e,t,r,n,o,_,l;return e=new Je({props:{backFunction:s[11]}}),{c(){Ie(e.$$.fragment),t=L(),r=p("div"),n=J("Сохранить"),this.h()},l(u){ke(e.$$.fragment,u),t=M(u),r=g(u,"DIV",{class:!0});var f=E(r);n=z(f,"Сохранить"),f.forEach(h),this.h()},h(){i(r,"class","save text-16s c-blue")},m(u,f){qe(e,u,f),B(u,t,f),B(u,r,f),c(r,n),o=!0,_||(l=ee(r,"click",s[16]),_=!0)},p:De,i(u){o||(ve(e.$$.fragment,u),o=!0)},o(u){ge(e.$$.fragment,u),o=!1},d(u){Pe(e,u),u&&h(t),u&&h(r),_=!1,l()}}}function ot(s){let e,t;return{c(){e=p("img"),this.h()},l(r){e=g(r,"IMG",{src:!0,alt:!0}),this.h()},h(){pe(e.src,t=s[6].avatar)||i(e,"src",t),i(e,"alt","q")},m(r,n){B(r,e,n)},p:De,d(r){r&&h(e)}}}function ct(s){let e,t;return{c(){e=p("img"),this.h()},l(r){e=g(r,"IMG",{src:!0,alt:!0}),this.h()},h(){pe(e.src,t=s[0])||i(e,"src",t),i(e,"alt","q")},m(r,n){B(r,e,n)},p(r,n){n[0]&1&&!pe(e.src,t=r[0])&&i(e,"src",t)},d(r){r&&h(e)}}}function ut(s){let e,t,r,n,o,_,l,u,f,b,k,N,y,D,I,T,R,x,w,re,X,W,K,Q,G,O,ae,ce,S,U,ie,H,te,ue,se,$,le,v,q;function C(m,d){if(m[0])return ct;if(m[6].avatar)return ot}let F=C(s),V=F&&F(s);return{c(){e=p("div"),t=J("Настройки"),r=L(),n=p("div"),o=p("div"),V&&V.c(),_=L(),l=p("div"),u=J("Редактировать фото"),f=L(),b=p("form"),k=p("div"),N=p("label"),y=J("Имя"),D=L(),I=p("input"),R=L(),x=p("div"),w=p("label"),re=J("Фамилия"),X=L(),W=p("input"),Q=L(),G=p("div"),O=p("label"),ae=J("Почта"),ce=L(),S=p("input"),ie=L(),H=p("div"),te=p("div"),ue=J("Выход"),se=L(),$=p("div"),le=J("Удалить профиль"),this.h()},l(m){e=g(m,"DIV",{class:!0});var d=E(e);t=z(d,"Настройки"),d.forEach(h),r=M(m),n=g(m,"DIV",{class:!0});var P=E(n);o=g(P,"DIV",{class:!0});var ne=E(o);V&&V.l(ne),ne.forEach(h),_=M(P),l=g(P,"DIV",{class:!0});var j=E(l);u=z(j,"Редактировать фото"),j.forEach(h),P.forEach(h),f=M(m),b=g(m,"FORM",{action:!0,class:!0});var de=E(b);k=g(de,"DIV",{class:!0});var a=E(k);N=g(a,"LABEL",{class:!0,for:!0});var A=E(N);y=z(A,"Имя"),A.forEach(h),D=M(a),I=g(a,"INPUT",{class:!0,type:!0,name:!0,maxlength:!0,placeholder:!0}),a.forEach(h),R=M(de),x=g(de,"DIV",{class:!0});var Z=E(x);w=g(Z,"LABEL",{class:!0,for:!0});var oe=E(w);re=z(oe,"Фамилия"),oe.forEach(h),X=M(Z),W=g(Z,"INPUT",{class:!0,type:!0,name:!0,maxlength:!0,placeholder:!0}),Z.forEach(h),Q=M(de),G=g(de,"DIV",{class:!0});var Y=E(G);O=g(Y,"LABEL",{class:!0,for:!0});var he=E(O);ae=z(he,"Почта"),he.forEach(h),ce=M(Y),S=g(Y,"INPUT",{class:!0,type:!0,name:!0,maxlength:!0,placeholder:!0}),Y.forEach(h),de.forEach(h),ie=M(m),H=g(m,"DIV",{class:!0});var me=E(H);te=g(me,"DIV",{class:!0});var _e=E(te);ue=z(_e,"Выход"),_e.forEach(h),se=M(me),$=g(me,"DIV",{class:!0});var ye=E($);le=z(ye,"Удалить профиль"),ye.forEach(h),me.forEach(h),this.h()},h(){i(e,"class","text-20b title svelte-q8vy7"),i(o,"class","user-icon svelte-q8vy7"),i(l,"class","edit-photo text-14s c-blue"),i(n,"class","user-container bg-l-gray svelte-q8vy7"),i(N,"class","text-12s c-dark-gray"),i(N,"for","weight"),i(I,"class",T="text-14s "+(s[5].names?"error":"")+" svelte-q8vy7"),i(I,"type","text"),i(I,"name","name"),i(I,"maxlength","20"),i(I,"placeholder",s[6].name),i(k,"class","name-container svelte-q8vy7"),i(w,"class","text-12s c-dark-gray"),i(w,"for","height"),i(W,"class",K="text-14s "+(s[5].names?"error":"")+" svelte-q8vy7"),i(W,"type","text"),i(W,"name","lastname"),i(W,"maxlength","20"),i(W,"placeholder",s[6].lastname),i(x,"class","lastname-container svelte-q8vy7"),i(O,"class","text-12s c-dark-gray"),i(O,"for","email"),i(S,"class",U="text-14s "+(s[5].email?"error":"")+" svelte-q8vy7"),i(S,"type","email"),i(S,"name","email"),i(S,"maxlength","30"),i(S,"placeholder",s[6].email),i(G,"class","email-container svelte-q8vy7"),i(b,"action","#"),i(b,"class","edit-form svelte-q8vy7"),i(te,"class","exit text-14s bg-l-gray svelte-q8vy7"),i($,"class","delete text-14s c-red svelte-q8vy7"),i(H,"class","edit-btn-wrapper svelte-q8vy7")},m(m,d){B(m,e,d),c(e,t),B(m,r,d),B(m,n,d),c(n,o),V&&V.m(o,null),c(n,_),c(n,l),c(l,u),B(m,f,d),B(m,b,d),c(b,k),c(k,N),c(N,y),c(k,D),c(k,I),c(b,R),c(b,x),c(x,w),c(w,re),c(x,X),c(x,W),c(b,Q),c(b,G),c(G,O),c(O,ae),c(G,ce),c(G,S),s[18](b),B(m,ie,d),B(m,H,d),c(H,te),c(te,ue),c(H,se),c(H,$),c($,le),v||(q=[ee(l,"click",s[17]),ee(te,"click",s[19]),ee($,"click",s[20])],v=!0)},p(m,d){F===(F=C(m))&&V?V.p(m,d):(V&&V.d(1),V=F&&F(m),V&&(V.c(),V.m(o,null))),d[0]&32&&T!==(T="text-14s "+(m[5].names?"error":"")+" svelte-q8vy7")&&i(I,"class",T),d[0]&32&&K!==(K="text-14s "+(m[5].names?"error":"")+" svelte-q8vy7")&&i(W,"class",K),d[0]&32&&U!==(U="text-14s "+(m[5].email?"error":"")+" svelte-q8vy7")&&i(S,"class",U)},d(m){m&&h(e),m&&h(r),m&&h(n),V&&V.d(),m&&h(f),m&&h(b),s[18](null),m&&h(ie),m&&h(H),v=!1,Ae(q)}}}function Fe(s){let e,t,r,n,o,_,l,u,f,b,k,N;return t=new rt({props:{image:s[1],aspect:1,zoom:"1",crop:{x:0,y:0}}}),t.$on("cropcomplete",s[9]),{c(){e=p("div"),Ie(t.$$.fragment),r=L(),n=p("div"),o=p("img"),l=L(),u=p("div"),f=J("Сохранить"),this.h()},l(y){e=g(y,"DIV",{class:!0,style:!0});var D=E(e);ke(t.$$.fragment,D),D.forEach(h),r=M(y),n=g(y,"DIV",{class:!0});var I=E(n);o=g(I,"IMG",{class:!0,src:!0,alt:!0,style:!0}),I.forEach(h),l=M(y),u=g(y,"DIV",{class:!0});var T=E(u);f=z(T,"Сохранить"),T.forEach(h),this.h()},h(){i(e,"class","cropper-box svelte-q8vy7"),fe(e,"position","relative"),fe(e,"width","100%"),fe(e,"height","100%"),i(o,"class","prof-pic svelte-q8vy7"),pe(o.src,_=s[1])||i(o,"src",_),i(o,"alt","Profile example"),i(o,"style",s[8]),i(n,"class","prof-pic-wrapper svelte-q8vy7"),i(u,"class","save-avatar text-16s c-blue svelte-q8vy7")},m(y,D){B(y,e,D),qe(t,e,null),B(y,r,D),B(y,n,D),c(n,o),s[26](o),B(y,l,D),B(y,u,D),c(u,f),b=!0,k||(N=ee(u,"click",s[27]),k=!0)},p(y,D){const I={};D[0]&2&&(I.image=y[1]),t.$set(I),(!b||D[0]&2&&!pe(o.src,_=y[1]))&&i(o,"src",_)},i(y){b||(ve(t.$$.fragment,y),b=!0)},o(y){ge(t.$$.fragment,y),b=!1},d(y){y&&h(e),Pe(t),y&&h(r),y&&h(n),s[26](null),y&&h(l),y&&h(u),k=!1,N()}}}function dt(s){let e,t,r,n,o,_,l,u,f,b,k,N,y,D,I,T,R,x,w,re,X,W,K,Q,G,O,ae,ce,S,U,ie,H,te,ue,se,$,le,v,q,C,F,V;e=new Xe({props:{bgcolor:ht,$$slots:{default:[lt]},$$scope:{ctx:s}}}),r=new Ye({props:{$$slots:{default:[ut]},$$scope:{ctx:s}}});let m=s[1]&&!s[0]&&Fe(s);return{c(){Ie(e.$$.fragment),t=L(),Ie(r.$$.fragment),n=L(),o=p("div"),_=p("div"),l=p("div"),u=L(),f=p("div"),b=p("div"),k=J("Изменить фотографию?"),N=L(),y=p("div"),D=J("Выбрать из галерии"),I=L(),T=p("input"),R=L(),x=p("div"),w=J("Удалить"),re=L(),X=p("div"),W=J("Отменить"),K=L(),m&&m.c(),Q=L(),G=p("div"),O=p("div"),ae=p("div"),ce=L(),S=p("div"),U=p("div"),ie=J("Вы уверены, что хотите"),H=p("br"),te=J("выйти из профиля?"),ue=L(),se=p("div"),$=J("Да"),le=L(),v=p("div"),q=J("Отмена"),this.h()},l(d){ke(e.$$.fragment,d),t=M(d),ke(r.$$.fragment,d),n=M(d),o=g(d,"DIV",{class:!0});var P=E(o);_=g(P,"DIV",{class:!0});var ne=E(_);l=g(ne,"DIV",{class:!0}),E(l).forEach(h),u=M(ne),f=g(ne,"DIV",{class:!0});var j=E(f);b=g(j,"DIV",{class:!0});var de=E(b);k=z(de,"Изменить фотографию?"),de.forEach(h),N=M(j),y=g(j,"DIV",{class:!0});var a=E(y);D=z(a,"Выбрать из галерии"),a.forEach(h),I=M(j),T=g(j,"INPUT",{style:!0,type:!0,accept:!0,class:!0}),R=M(j),x=g(j,"DIV",{class:!0});var A=E(x);w=z(A,"Удалить"),A.forEach(h),re=M(j),X=g(j,"DIV",{class:!0});var Z=E(X);W=z(Z,"Отменить"),Z.forEach(h),j.forEach(h),ne.forEach(h),P.forEach(h),K=M(d),m&&m.l(d),Q=M(d),G=g(d,"DIV",{class:!0});var oe=E(G);O=g(oe,"DIV",{class:!0});var Y=E(O);ae=g(Y,"DIV",{class:!0}),E(ae).forEach(h),ce=M(Y),S=g(Y,"DIV",{class:!0});var he=E(S);U=g(he,"DIV",{class:!0});var me=E(U);ie=z(me,"Вы уверены, что хотите"),H=g(me,"BR",{}),te=z(me,"выйти из профиля?"),me.forEach(h),ue=M(he),se=g(he,"DIV",{class:!0});var _e=E(se);$=z(_e,"Да"),_e.forEach(h),le=M(he),v=g(he,"DIV",{class:!0});var ye=E(v);q=z(ye,"Отмена"),ye.forEach(h),he.forEach(h),Y.forEach(h),oe.forEach(h),this.h()},h(){i(l,"class","swiper svelte-q8vy7"),i(b,"class","photo-dialog__title text-14s svelte-q8vy7"),i(y,"class","cancel text-14s bg-l-gray svelte-q8vy7"),fe(T,"display","none"),i(T,"type","file"),i(T,"accept",".jpg, .jpeg, .png"),i(T,"class","svelte-q8vy7"),i(x,"class","delete-button text-14s c-red svelte-q8vy7"),i(X,"class","cancel text-14s svelte-q8vy7"),i(f,"class","photo-dialog__wrapper svelte-q8vy7"),i(_,"class","photo-dialog svelte-q8vy7"),i(o,"class","modalphoto svelte-q8vy7"),i(ae,"class","swiper svelte-q8vy7"),i(U,"class","photo-dialog__title text-14s svelte-q8vy7"),i(se,"class","cancel text-14s bg-l-gray svelte-q8vy7"),i(v,"class","delete-button text-14s svelte-q8vy7"),i(S,"class","photo-dialog__wrapper svelte-q8vy7"),i(O,"class","photo-dialog svelte-q8vy7"),i(G,"class","modalexit svelte-q8vy7")},m(d,P){qe(e,d,P),B(d,t,P),qe(r,d,P),B(d,n,P),B(d,o,P),c(o,_),c(_,l),c(_,u),c(_,f),c(f,b),c(b,k),c(f,N),c(f,y),c(y,D),c(f,I),c(f,T),s[23](T),c(f,R),c(f,x),c(x,w),c(f,re),c(f,X),c(X,W),B(d,K,P),m&&m.m(d,P),B(d,Q,P),B(d,G,P),c(G,O),c(O,ae),c(O,ce),c(O,S),c(S,U),c(U,ie),c(U,H),c(U,te),c(S,ue),c(S,se),c(se,$),c(S,le),c(S,v),c(v,q),C=!0,F||(V=[ee(y,"click",s[21]),ee(T,"change",s[22]),ee(x,"click",s[24]),ee(X,"click",s[25]),ee(se,"click",s[28]),ee(v,"click",s[29])],F=!0)},p(d,P){const ne={};P[1]&64&&(ne.$$scope={dirty:P,ctx:d}),e.$set(ne);const j={};P[0]&41|P[1]&64&&(j.$$scope={dirty:P,ctx:d}),r.$set(j),d[1]&&!d[0]?m?(m.p(d,P),P[0]&3&&ve(m,1)):(m=Fe(d),m.c(),ve(m,1),m.m(Q.parentNode,Q)):m&&(je(),ge(m,1,1,()=>{m=null}),Ge())},i(d){C||(ve(e.$$.fragment,d),ve(r.$$.fragment,d),ve(m),C=!0)},o(d){ge(e.$$.fragment,d),ge(r.$$.fragment,d),ge(m),C=!1},d(d){Pe(e,d),d&&h(t),Pe(r,d),d&&h(n),d&&h(o),s[23](null),d&&h(K),m&&m.d(d),d&&h(Q),d&&h(G),F=!1,Ae(V)}}}let ht="aic";async function ft(s,e){const t=await(await fetch(s)).blob();return new File([t],e,{type:t.type})}function mt(s,e,t){let r;Ue(s,ze,v=>t(32,r=v));let{data:n}=e,o=n.token,_=n.user,l,u,f,b,k;async function N(){const v=await ft(b,"smaple.png"),q=new FormData;q.append("avatar",v),await fetch(`${r}/api/avatar`,{method:"POST",headers:{Authorization:`Bearer ${o}`},body:q})}function y(v){document.querySelector(".modalphoto").classList.remove("_active");let q=v.target.files[0],C=new FileReader;C.onload=F=>{t(1,l=F.target.result)},C.readAsDataURL(q)}let D,I;function T(v){f=v.detail.pixels;const{x:q,y:C,width:F}=v.detail.pixels,V=200/F;t(4,D.style=`margin: ${-C*V}px 0 0 ${-q*V}px; width: ${D.naturalWidth*V}px;`,D)}async function R(){t(0,b=await nt(l,f)),N()}let x=()=>be("/profile"),w={names:!1,email:!1};function re(){t(5,w.names=!1,w),t(5,w.email=!1,w);const v=k.elements.name.value,q=k.elements.lastname.value,C=k.elements.email.value,F=/[!@#$%^&*(),.?":{}|<>]/,V=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/;if(!v&&!q&&!C){x();return}v&&(v.match(F)||v.includes(" "))&&t(5,w.names=!0,w),q&&(q.match(F)||q.includes(" ")||q=="")&&t(5,w.names=!0,w),C&&(C.match(V)||t(5,w.email=!0,w)),!w.names&&!w.email&&X()}async function X(){const v=new FormData(k),q={};for(const[C,F]of v.entries())F&&(q[C]=F);console.log(q);try{const C=await fetch(`${r}/api/user`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(q)});if(C.ok)x();else{const F=await C.json();console.error("Ошибка при отправке формы:",F.detail)}}catch(C){console.error("Ошибка при отправке запроса:",C)}}async function W(){try{(await fetch(`${r}/api/avatar`,{method:"DELETE",headers:{Authorization:`Bearer ${o}`}})).ok&&be("/profile")}catch(v){console.error("Ошибка при отправке запроса:",v)}}async function K(){try{(await fetch(`${r}/api/delete_user`,{method:"POST",headers:{Authorization:`Bearer ${o}`}})).ok&&be("/trainings")}catch(v){console.error("Ошибка при отправке запроса:",v)}}const Q=()=>{re()},G=()=>document.querySelector(".modalphoto").classList.add("_active");function O(v){we[v?"unshift":"push"](()=>{k=v,t(3,k)})}const ae=()=>document.querySelector(".modalexit").classList.add("_active"),ce=()=>{K()},S=()=>{u.click()},U=v=>y(v);function ie(v){we[v?"unshift":"push"](()=>{u=v,t(2,u)})}const H=()=>W(),te=()=>document.querySelector(".modalphoto").classList.remove("_active");function ue(v){we[v?"unshift":"push"](()=>{D=v,t(4,D)})}const se=()=>{R()},$=()=>be("/logout"),le=()=>document.querySelector(".modalexit").classList.remove("_active");return s.$$set=v=>{"data"in v&&t(15,n=v.data)},s.$$.update=()=>{s.$$.dirty[0]&1},[b,l,u,k,D,w,_,y,I,T,R,x,re,W,K,n,Q,G,O,ae,ce,S,U,ie,H,te,ue,se,$,le]}class Et extends Be{constructor(e){super(),Oe(this,e,mt,dt,Ze,{data:15},null,[-1,-1])}}export{Et as component};
